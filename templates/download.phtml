{% extends 'base.html' %}

{% block content %}
    <h2>{{ file.getOriginalName() }}</h2>

    {% if file.isImage() %}
        <img class="media" src="/{{ file.getThumbnail() }}">
    {% endif %}

    {% if file.isAudio() %}
        <audio class="media" src="/{{ file.getPath() }}/{{ file.getNewName() }}" controls></audio>
    {% endif %}    

    {% if file.isVideo() %}
        <video class="media" src="/{{ file.getPath() }}/{{ file.getNewName() }}" controls></video>
    {% endif %}

    <ul class="list-unstyled files">
        <li>Size: {{ file.getSize() }}</li>
        <li>Type: {{ file.getMimeType() }}</li>

        <!-- mb somthing more -->
    </ul>

    <a href="{{ path_for('dwnld', {'id': file.getId()}) }}">
        Download {{ file.getOriginalName() }}
    </a>

    <hr>

    <div class="comments">
        <form method="POST" class="" action="{{ path_for('download', {'id': file.getId()}) }}">
            <div class="form-group"><input type="text" class="form-control" name="author" placeholder="Name"></div>
            <div class="form-group"><textarea class="form-control" name="content"></textarea></div>
            
            <button type="submit" class="btn btn-default">Submit</button>

            <input type="hidden" name="{{ csrfNameKey }}" value="{{ csrfName }}">
            <input type="hidden" name="{{ csrfValueKey }}" value="{{ csrfValue }}">
        </form>

        {% for comment in file.getComments() %}
            <div class="comment" style="margin-left:{{ comment.getDepth() * 20 }}px">
                <b>{{ comment.getAuthor() }}</b> <span class="date">{{ comment.getDate().format('Y-m-d H:i:s') }}</span>
                <div class="content">
                    {{ comment.getContent() }}
                </div>

                <form method="POST" action="{{ path_for('download', {'id': file.getId()}) }}" style="margin-left:{{ (comment.getDepth() + 1) * 20 }}px">
                    <input type="hidden" name="parent" value="{{ comment.getId() }}">

                    <div class="form-group"><input type="text" class="form-control" name="author"></div>
                    <div class="form-group"><textarea class="form-control" name="content"></textarea></div>

                    <button type="submit" class="btn btn-default">Submit</button>

                    <input type="hidden" name="{{ csrfNameKey }}" value="{{ csrfName }}">
                    <input type="hidden" name="{{ csrfValueKey }}" value="{{ csrfValue }}">
                </form>
            </div>
        {% endfor %}
    </div>
{% endblock %}